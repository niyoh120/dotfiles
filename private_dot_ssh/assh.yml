defaults:
  # Defaults are applied to each hosts
  Port: 22
  ServerAliveInterval: 180
  ControlMaster: auto
  ControlPath: ~/.cache/ssh/cm/%h-%p-%r.sock
  ControlPersist: yes

  Hooks:
    # Automatically backup ~/.ssh/config
    BeforeConfigWrite:
      - exec set -x; cp {{.SSHConfigPath}} {{.SSHConfigPath}}.bak

    AfterConfigWrite:
      # Concat another `ssh_config` file with the one just generated by `assh`
      - exec cat ~/.colima/ssh_config >> {{.SSHConfigPath}}

      # Alert me with a Desktop notification
      - notify "{{.SSHConfigPath}} has been rewritten"

    OnConnect:
      # Alert me with a Desktop notification
      - notify New SSH connection to {{.Host.Prototype}} at {{.Stats.ConnectedAt}}

      # Write the host prototype to the terminal stderr
      - write New SSH connection to {{.Host.Prototype}}

    OnDisconnect:
      # write on terminal and in a Desktop notification some statistics about the finished connection
      - "write  SSH connection to {{.Host.HostName}} closed, {{.Stats.WrittenBytes }} bytes written in {{.Stats.ConnectionDuration}} ({{.Stats.AverageSpeed}}bps)"
      - "notify SSH connection to {{.Host.HostName}} closed, {{.Stats.WrittenBytes }} bytes written in {{.Stats.ConnectionDuration}} ({{.Stats.AverageSpeed}}bps)"

includes:
  - ~/.ssh/assh.d/*.yml
  - ~/.local/temp/assh.d/*.yml
